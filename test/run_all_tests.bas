10 REM ==========================================
20 REM  GW-BASIC C PORT - AUTOMATED TESTS
30 REM  STOPS ON FIRST FAILURE
40 REM ==========================================
50 PRINT "GW-BASIC C PORT TEST SUITE"
60 PRINT "================================"
70 PRINT
80 TESTCOUNT = 0
90 REM
100 REM === ARITHMETIC TESTS ===
110 PRINT "TESTING ARITHMETIC..."
120 TESTCOUNT = TESTCOUNT + 1
130 IF 2 + 3 = 5 THEN 150
140 PRINT "FAIL: 2 + 3 <> 5": STOP
150 TESTCOUNT = TESTCOUNT + 1
160 IF 10 - 4 = 6 THEN 180
170 PRINT "FAIL: 10 - 4 <> 6": STOP
180 TESTCOUNT = TESTCOUNT + 1
190 IF 3 * 4 = 12 THEN 210
200 PRINT "FAIL: 3 * 4 <> 12": STOP
210 TESTCOUNT = TESTCOUNT + 1
220 IF 15 / 3 = 5 THEN 240
230 PRINT "FAIL: 15 / 3 <> 5": STOP
240 TESTCOUNT = TESTCOUNT + 1
250 IF 2 ^ 3 = 8 THEN 270
260 PRINT "FAIL: 2 ^ 3 <> 8": STOP
270 PRINT "  ARITHMETIC: PASS"
280 REM
290 REM === COMPARISON TESTS ===
300 PRINT "TESTING COMPARISONS..."
310 TESTCOUNT = TESTCOUNT + 1
320 IF (5 = 5) <> 0 THEN 340
330 PRINT "FAIL: 5 = 5 IS FALSE": STOP
340 TESTCOUNT = TESTCOUNT + 1
350 IF (5 < 10) <> 0 THEN 370
360 PRINT "FAIL: 5 < 10 IS FALSE": STOP
370 TESTCOUNT = TESTCOUNT + 1
380 IF (10 > 5) <> 0 THEN 400
390 PRINT "FAIL: 10 > 5 IS FALSE": STOP
400 TESTCOUNT = TESTCOUNT + 1
410 IF (5 <= 5) <> 0 THEN 430
420 PRINT "FAIL: 5 <= 5 IS FALSE": STOP
430 TESTCOUNT = TESTCOUNT + 1
440 IF (5 >= 5) <> 0 THEN 460
450 PRINT "FAIL: 5 >= 5 IS FALSE": STOP
460 TESTCOUNT = TESTCOUNT + 1
470 IF (5 <> 6) <> 0 THEN 490
480 PRINT "FAIL: 5 <> 6 IS FALSE": STOP
490 PRINT "  COMPARISONS: PASS"
500 REM
510 REM === VARIABLE TESTS ===
520 PRINT "TESTING VARIABLES..."
530 TESTCOUNT = TESTCOUNT + 1
540 MYVAR = 42
550 IF MYVAR = 42 THEN 570
560 PRINT "FAIL: MYVAR <> 42": STOP
570 TESTCOUNT = TESTCOUNT + 1
580 FLOATVAL = 3.14
590 IF FLOATVAL > 3.13 THEN 610
600 PRINT "FAIL: FLOATVAL NOT > 3.13": STOP
610 IF FLOATVAL < 3.15 THEN 630
620 PRINT "FAIL: FLOATVAL NOT < 3.15": STOP
630 TESTCOUNT = TESTCOUNT + 1
640 MYSTR$ = "TEST"
650 IF LEN(MYSTR$) = 4 THEN 670
660 PRINT "FAIL: LEN(MYSTR$) <> 4": STOP
670 PRINT "  VARIABLES: PASS"
680 REM
690 REM === MATH FUNCTION TESTS ===
700 PRINT "TESTING MATH FUNCTIONS..."
710 TESTCOUNT = TESTCOUNT + 1
720 IF ABS(-5) = 5 THEN 740
730 PRINT "FAIL: ABS(-5) <> 5": STOP
740 TESTCOUNT = TESTCOUNT + 1
750 IF ABS(5) = 5 THEN 770
760 PRINT "FAIL: ABS(5) <> 5": STOP
770 TESTCOUNT = TESTCOUNT + 1
780 IF SGN(-5) = -1 THEN 800
790 PRINT "FAIL: SGN(-5) <> -1": STOP
800 TESTCOUNT = TESTCOUNT + 1
810 IF SGN(0) = 0 THEN 830
820 PRINT "FAIL: SGN(0) <> 0": STOP
830 TESTCOUNT = TESTCOUNT + 1
840 IF SGN(5) = 1 THEN 860
850 PRINT "FAIL: SGN(5) <> 1": STOP
860 TESTCOUNT = TESTCOUNT + 1
870 IF INT(3.7) = 3 THEN 890
880 PRINT "FAIL: INT(3.7) <> 3": STOP
890 TESTCOUNT = TESTCOUNT + 1
900 IF INT(-3.7) = -4 THEN 920
910 PRINT "FAIL: INT(-3.7) <> -4": STOP
920 TESTCOUNT = TESTCOUNT + 1
930 IF SQR(16) = 4 THEN 950
940 PRINT "FAIL: SQR(16) <> 4": STOP
950 TESTCOUNT = TESTCOUNT + 1
960 IF SQR(25) = 5 THEN 980
970 PRINT "FAIL: SQR(25) <> 5": STOP
980 TESTCOUNT = TESTCOUNT + 1
990 XVAL = SIN(0)
1000 IF XVAL > -0.001 THEN 1020
1010 PRINT "FAIL: SIN(0) TOO LOW": STOP
1020 IF XVAL < 0.001 THEN 1040
1030 PRINT "FAIL: SIN(0) TOO HIGH": STOP
1040 TESTCOUNT = TESTCOUNT + 1
1050 XVAL = COS(0)
1060 IF XVAL > 0.999 THEN 1080
1070 PRINT "FAIL: COS(0) TOO LOW": STOP
1080 IF XVAL < 1.001 THEN 1100
1090 PRINT "FAIL: COS(0) TOO HIGH": STOP
1100 TESTCOUNT = TESTCOUNT + 1
1110 XVAL = EXP(1)
1120 IF XVAL > 2.71 THEN 1140
1130 PRINT "FAIL: EXP(1) TOO LOW": STOP
1140 IF XVAL < 2.72 THEN 1160
1150 PRINT "FAIL: EXP(1) TOO HIGH": STOP
1160 TESTCOUNT = TESTCOUNT + 1
1170 XVAL = LOG(2.718281828)
1180 IF XVAL > 0.99 THEN 1200
1190 PRINT "FAIL: LOG(E) TOO LOW": STOP
1200 IF XVAL < 1.01 THEN 1220
1210 PRINT "FAIL: LOG(E) TOO HIGH": STOP
1220 PRINT "  MATH FUNCTIONS: PASS"
1230 REM
1240 REM === STRING FUNCTION TESTS ===
1250 PRINT "TESTING STRING FUNCTIONS..."
1260 TESTCOUNT = TESTCOUNT + 1
1270 IF LEN("HELLO") = 5 THEN 1290
1280 PRINT "FAIL: LEN(HELLO) <> 5": STOP
1290 TESTCOUNT = TESTCOUNT + 1
1300 IF LEN("") = 0 THEN 1320
1310 PRINT "FAIL: LEN() <> 0": STOP
1320 TESTCOUNT = TESTCOUNT + 1
1330 IF ASC("A") = 65 THEN 1350
1340 PRINT "FAIL: ASC(A) <> 65": STOP
1350 TESTCOUNT = TESTCOUNT + 1
1360 IF ASC("Z") = 90 THEN 1380
1370 PRINT "FAIL: ASC(Z) <> 90": STOP
1380 TESTCOUNT = TESTCOUNT + 1
1390 CHRTEST$ = CHR$(65)
1400 IF CHRTEST$ = "A" THEN 1420
1410 PRINT "FAIL: CHR$(65) <> A": STOP
1420 TESTCOUNT = TESTCOUNT + 1
1430 LEFTTEST$ = LEFT$("HELLO",3)
1440 IF LEFTTEST$ = "HEL" THEN 1460
1450 PRINT "FAIL: LEFT$(HELLO,3)": STOP
1460 TESTCOUNT = TESTCOUNT + 1
1470 RIGHTTEST$ = RIGHT$("HELLO",3)
1480 IF RIGHTTEST$ = "LLO" THEN 1500
1490 PRINT "FAIL: RIGHT$(HELLO,3)": STOP
1500 TESTCOUNT = TESTCOUNT + 1
1510 MIDTEST$ = MID$("HELLO",2,3)
1520 IF MIDTEST$ = "ELL" THEN 1540
1530 PRINT "FAIL: MID$(HELLO,2,3)": STOP
1540 TESTCOUNT = TESTCOUNT + 1
1550 XVAL = VAL("123")
1560 IF XVAL = 123 THEN 1580
1570 PRINT "FAIL: VAL(123) <> 123": STOP
1580 TESTCOUNT = TESTCOUNT + 1
1590 STRTEST$ = STR$(456)
1600 IF VAL(STRTEST$) = 456 THEN 1620
1610 PRINT "FAIL: STR$(456)": STOP
1620 PRINT "  STRING FUNCTIONS: PASS"
1630 REM
1640 REM === FOR/NEXT TESTS ===
1650 PRINT "TESTING FOR/NEXT..."
1660 TESTCOUNT = TESTCOUNT + 1
1670 SUMVAL = 0
1680 FOR I = 1 TO 5
1690 SUMVAL = SUMVAL + I
1700 NEXT I
1710 IF SUMVAL = 15 THEN 1730
1720 PRINT "FAIL: SUM 1-5 <> 15": STOP
1730 TESTCOUNT = TESTCOUNT + 1
1740 SUMVAL = 0
1750 FOR I = 0 TO 10 STEP 2
1760 SUMVAL = SUMVAL + 1
1770 NEXT I
1780 IF SUMVAL = 6 THEN 1800
1790 PRINT "FAIL: STEP 2 COUNT": STOP
1800 TESTCOUNT = TESTCOUNT + 1
1810 SUMVAL = 0
1820 FOR I = 5 TO 1 STEP -1
1830 SUMVAL = SUMVAL + I
1840 NEXT I
1850 IF SUMVAL = 15 THEN 1870
1860 PRINT "FAIL: COUNTDOWN SUM": STOP
1870 TESTCOUNT = TESTCOUNT + 1
1880 SUMVAL = 0
1890 FOR I = 1 TO 3
1900 FOR J = 1 TO 3
1910 SUMVAL = SUMVAL + 1
1920 NEXT J
1930 NEXT I
1940 IF SUMVAL = 9 THEN 1960
1950 PRINT "FAIL: NESTED LOOPS": STOP
1960 PRINT "  FOR/NEXT: PASS"
1970 REM
1980 REM === GOSUB/RETURN TESTS ===
1990 PRINT "TESTING GOSUB/RETURN..."
2000 TESTCOUNT = TESTCOUNT + 1
2010 GOSUBRESULT = 0
2020 GOSUB 2500
2030 IF GOSUBRESULT = 1 THEN 2050
2040 PRINT "FAIL: GOSUB NOT CALLED": STOP
2050 TESTCOUNT = TESTCOUNT + 1
2060 GOSUBRESULT = 0
2070 GOSUB 2520
2080 IF GOSUBRESULT = 2 THEN 2100
2090 PRINT "FAIL: NESTED GOSUB": STOP
2100 PRINT "  GOSUB/RETURN: PASS"
2110 REM
2120 REM === ARRAY TESTS ===
2130 PRINT "TESTING ARRAYS..."
2140 TESTCOUNT = TESTCOUNT + 1
2150 DIM TESTARR(10)
2160 FOR I = 1 TO 10
2170 TESTARR(I) = I * 2
2180 NEXT I
2190 IF TESTARR(5) = 10 THEN 2210
2200 PRINT "FAIL: TESTARR(5) <> 10": STOP
2210 TESTCOUNT = TESTCOUNT + 1
2220 IF TESTARR(1) = 2 THEN 2240
2230 PRINT "FAIL: TESTARR(1) <> 2": STOP
2240 TESTCOUNT = TESTCOUNT + 1
2250 IF TESTARR(10) = 20 THEN 2270
2260 PRINT "FAIL: TESTARR(10) <> 20": STOP
2270 TESTCOUNT = TESTCOUNT + 1
2280 DIM MATRIX(3,3)
2290 MATRIX(2,2) = 99
2300 IF MATRIX(2,2) = 99 THEN 2320
2310 PRINT "FAIL: MATRIX(2,2) <> 99": STOP
2320 PRINT "  ARRAYS: PASS"
2330 REM
2340 REM === IF/THEN/ELSE TESTS ===
2350 PRINT "TESTING IF/THEN/ELSE..."
2360 TESTCOUNT = TESTCOUNT + 1
2370 IFRESULT = 0
2380 IF 1 = 1 THEN IFRESULT = 1 ELSE IFRESULT = 2
2390 IF IFRESULT = 1 THEN 2410
2400 PRINT "FAIL: IF TRUE THEN": STOP
2410 TESTCOUNT = TESTCOUNT + 1
2420 IFRESULT = 0
2430 IF 1 = 2 THEN IFRESULT = 1 ELSE IFRESULT = 2
2440 IF IFRESULT = 2 THEN 2460
2450 PRINT "FAIL: IF FALSE ELSE": STOP
2460 PRINT "  IF/THEN/ELSE: PASS"
2470 REM
2480 REM === ALL TESTS PASSED ===
2490 GOTO 2540
2500 GOSUBRESULT = 1
2510 RETURN
2520 GOSUB 2500
2530 GOSUBRESULT = GOSUBRESULT + 1
2540 PRINT
2550 PRINT "================================"
2560 PRINT "ALL "; TESTCOUNT; " TESTS PASSED!"
2570 PRINT "================================"
2580 END
